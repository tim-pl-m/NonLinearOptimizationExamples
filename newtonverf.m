function [x,iter] = newtonverf(x0,gradfun,hessfun)
    eps = 1;
    iter = 0;
    while eps >= 1e-6
        x = x0 - hessfun(x0)\gradfun(x0);
        eps = abs(x - x0);
        x0 = x;
        iter = iter + 1;
    end
end

%% Rosenbrock function:
% fun = @(x) [100*(x(2) - x(1)^2)^2 + (1-x(1))^2]
% gradfun = @(x) [400*x(1)^2 - 400*x(1)*x(2) + 2*x(1)-2; 200*(x(2) - x(1)^2)]
% hessfun = @(x) [1200*x(1)^2 - 400 * x(2) + 2, -400*x(1); -400*x(1), 200]

%% Beale function:
% fun = @(x) [1.5-x(1)(1-x(2))^2+(2.25-x(1)(1-x(2)^2))^2+(2.625-x(1)(1-x(2)^3))^2]
% gradfun = @(x) [2*x(1)*x(2)^6 + 2*x(1)*x(2)^4 - 4*x(1)*x(2)^3 - 4*x(1)*x(2)^2 + 6*x(1) + 5.25*x(2)^3 + 4.5*x(2)^2 - 2*x(2) - 10.75;...
%   6*x(1)^2*x(2)^5 + 4*x(1)^2*x(2)^3-6*x(1)^2*x(2)^2 + 15.75*x(1)*x(2)^2 + 9*x(1)*x(2)-2*x(1)+2*x(2)+1]
% hessfun = @(x) [2*x(2)^6+2*x(2)^4-4*x(2)^3-4*x(2)^2+6,...
% 12*x(1)*x(2)^5+8*x(1)*x(2)^5 + 8*x(1)*x(2)^3 - 12*x(1)*x(2)^2 - 8*x(1)*x(2)+15.75*x(2)^2+9*x(2)-2;...
% 12*x(1)*x(2)^5+8*x(1)*x(2)^5 + 8*x(1)*x(2)^3 - 12*x(1)*x(2)^2 - 8*x(1)*x(2)+15.75*x(2)^2+9*x(2)-2,...
% 30*x(1)^2*x(2) + 12*x(1)^2*x(2)^2-12*x(1)^2*x(2)+31.5*x(2)+9]

%% Spelluci function: 
% fun = @(x) [2*x(1)^3+x(2)^2+x(1)^2*x(2)^2+4*x(1)*x(2)+3] 
% gradfun = @(x)[6*x(1)^2 + 2*x(1)* x(2)^2 + 4 * x(2); 2 * x(2) + 2 * x(1)^2 * x(2) + 4 * x(1)]
% hessfun = @(x) [12*x(1) + 2*x(2),4*x(1)*x(2)+4;4*x(1)*x(2)+4, 2*x(1)^2 + 2]

